---
import { marked } from 'marked';
import Layout from '@/layouts/Layout.astro';
import { Image } from 'astro:assets';
import { ContentResource, OpenAPI, type HomePageContentModel } from '@/api';

OpenAPI.BASE = import.meta.env.PUBLIC_BASE_URL;
const nodes = await ContentResource.getContent20({ filter: ['contentType:homePage'] });
const node: HomePageContentModel = nodes.items[0];

const {
  title,
  content,
  featuredImage
} = node.properties
const baseUrl = import.meta.env.PUBLIC_BASE_URL_HTTPS

---

<Layout name={"Lead Software Engineer"}>
  <section class="flex md:flex-col gap-12">
    <aside>
      <figure class="max-w-[400px]">
        <picture>
          <source srcset=`${baseUrl}${featuredImage[0].url}?width=900&height=900&format=webp` type="image/webp">
          <source srcset=`${baseUrl}${featuredImage[0].url}?width=900&height=900` type="image/jpeg">
          <Image src=`${baseUrl}${featuredImage[0].url}?width=900&height=900` alt="Rick Butterfield" width="900" height="900" style="aspect-ratio: 1 / 1; width: 100%;" class="rounded-full" />
        </picture>
      </figure>
    </aside>
    <article class="c-content" set:html={marked.parse(content)}>
    </article>
  </section>
</Layout>
